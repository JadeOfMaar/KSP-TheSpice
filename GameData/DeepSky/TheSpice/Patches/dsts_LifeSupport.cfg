// Add LS byproduct to White Spice fuel cells
// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
@PART[dsts_fuelcell_srf]:NEEDS[USILifeSupport|TacLifeSupport|Snacks]
{
	@MODULE[ModuleResourceConverter]
	{
		//ExpectedCrew = 0.4
		// @INPUT_RESOURCE:NEEDS[TacLifeSupport]
		// {
			// @Ratio = 0.000558378 //0.001395946
		// }
		OUTPUT_RESOURCE:NEEDS[USILifeSupport]
		{
			ResourceName = Supplies
			Ratio = 0.0002 //0.0005
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[Snacks]
		{
			ResourceName = Snacks
			Ratio = 1.38892E-05 //0.000034723
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Food
			Ratio = 6.77083E-06 //0.000016927083333
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Water
			Ratio = 4.47523E-06 //0.000011188078704
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Oxygen
			Ratio = 0.000685415 //0.001713537562385
			DumpExcess = true
		}
	}
}

@PART[dsts_fuelcell_125|dsts_fuelcell_mk2]:NEEDS[USILifeSupport|TacLifeSupport|Snacks]
{
	@MODULE[ModuleResourceConverter]
	{
		//ExpectedCrew = 0.8
		// @INPUT_RESOURCE:NEEDS[TacLifeSupport]
		// {
			// @Ratio = 0.001116756 //0.001395946
		// }
		OUTPUT_RESOURCE:NEEDS[USILifeSupport]
		{
			ResourceName = Supplies
			Ratio = 0.0004 //0.0005
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[Snacks]
		{
			ResourceName = Snacks
			Ratio = 2.77784E-05 //0.000034723
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Food
			Ratio = 1.35417E-05 //0.000016927083333
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Water
			Ratio = 8.95046E-06 //0.000011188078704
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Oxygen
			Ratio = 0.00137083 //0.001713537562385
			DumpExcess = true
		}
	}
}

@PART[dsts_fuelcell_250]:NEEDS[USILifeSupport|TacLifeSupport|Snacks]
{
	@MODULE[ModuleResourceConverter]
	{
		//ExpectedCrew = 1.6
		// @INPUT_RESOURCE:NEEDS[TacLifeSupport]
		// {
			// @Ratio = 0.002233513 //0.001395946
		// }
		OUTPUT_RESOURCE:NEEDS[USILifeSupport]
		{
			ResourceName = Supplies
			Ratio = 0.0008
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[Snacks]
		{
			ResourceName = Snacks
			Ratio = 5.55568E-05 //0.000034723
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Food
			Ratio = 2.70833E-05 //0.000016927083333
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Water
			Ratio = 1.79009E-05 //0.000011188078704
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Oxygen
			Ratio = 0.00274166 //0.001713537562385
			DumpExcess = true
		}
	}
}

@PART[dsts_fusioncore]
{
	@MODULE[ModuleResourceConverter]:NEEDS[!NearFutureElectrical]
	{
		// Size 2 fuel cell *6.25
		
		// @INPUT_RESOURCE:NEEDS[TacLifeSupport]
		// {
			// @Ratio = 0.0087246625 //0.001395946
		// }
		OUTPUT_RESOURCE:NEEDS[USILifeSupport]
		{
			ResourceName = Supplies
			Ratio = 0.005
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[Snacks]
		{
			ResourceName = Snacks
			Ratio = 0.00034723 //0.000034723
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Food
			Ratio = 0.000169270625 //0.000016927083333
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Water
			Ratio = 0.000111880625 //0.000011188078704
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Oxygen
			Ratio = 0.017135375 //0.001713537562385
			DumpExcess = true
		}
	}
	
	@MODULE[FissionReactor]:NEEDS[NearFutureElectrical]
	{
		// Size 2 fuel cell *6.25
		
		// @INPUT_RESOURCE:NEEDS[TacLifeSupport]
		// {
			// @Ratio = 0.0087246625 //0.001395946
		// }
		OUTPUT_RESOURCE:NEEDS[USILifeSupport]
		{
			ResourceName = Supplies
			Ratio = 0.005
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[Snacks]
		{
			ResourceName = Snacks
			Ratio = 0.00034723 //0.000034723
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Food
			Ratio = 0.000169270625 //0.000016927083333
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Water
			Ratio = 0.000111880625 //0.000011188078704
			DumpExcess = true
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Oxygen
			Ratio = 0.017135375 //0.001713537562385
			DumpExcess = true
		}
	}
}


//Update descriptions
// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
@PART[dsts_spiceapp_srf|dsts_spiceapp_125|dsts_spiceapp_mk2|dsts_spiceapp_250]:NEEDS[USILifeSupport]
{
	@description = The Spice extends life. A set-and-forget part, this so-called hub extends life by passively dispersing the Spice throughout the vessel and delivering it to the kerbals themsevles-- rather, into the Supplies.
}
@PART[dsts_spiceapp_srf|dsts_spiceapp_125|dsts_spiceapp_mk2|dsts_spiceapp_250]:NEEDS[TacLifeSupport]
{
	@description = The Spice extends life. A set-and-forget part, this so-called hub extends life by passively dispersing the Spice throughout the vessel and delivering it to the kerbals themsevles-- rather, into the Food, Air and Water.
}
@PART[dsts_spiceapp_srf|dsts_spiceapp_125|dsts_spiceapp_mk2|dsts_spiceapp_250]:NEEDS[Snacks]
{
	@description = The Spice extends life. A set-and-forget part, this so-called hub extends life by passively dispersing the Spice throughout the vessel and delivering it to the kerbals themsevles-- rather, into the Snacks.
}


//Insert LS converter module
// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
@PART[dsts_spiceapp_srf]:NEEDS[USILifeSupport|TacLifeSupport|Snacks]
{
	MODULE
	{
		name = ModuleResourceConverter
		ConverterName = The Spice
		StartActionName = Start Extending Life
		StopActionName = Stop Extending Life
		ToggleActionName = Toggle The Spice
		AutoShutdown = false
		GeneratesHeat = false
		UseSpecialistBonus = false
		
		//ExpectedCrew = 2.15
		INPUT_RESOURCE
		{
			ResourceName = SpiceMelange
			Ratio = 0.000671875 //0.003125
			%Ratio:NEEDS[TacLifeSupport] = 0.003001283 //0.001395946
		}
		INPUT_RESOURCE
		{
			ResourceName = ElectricCharge
			Ratio = 0.0215
		}
		OUTPUT_RESOURCE:NEEDS[USILifeSupport]
		{
			ResourceName = Supplies
			Ratio = 0.001075 //0.0005
			DumpExcess = false
		}
		OUTPUT_RESOURCE:NEEDS[Snacks]
		{
			ResourceName = Snacks
			Ratio = 7.46545E-05 //0.000034723
			DumpExcess = false
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Food
			Ratio = 3.63932E-05 //0.000016927083333
			DumpExcess = false
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Water
			Ratio = 2.40544E-05 //0.000011188078704
			DumpExcess = false
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Oxygen
			Ratio = 0.003684106 //0.001713537562385
			DumpExcess = false
		}
	}
}

@PART[dsts_spiceapp_125|dsts_spiceapp_mk2]:NEEDS[USILifeSupport|TacLifeSupport|Snacks]
{
	MODULE
	{
		name = ModuleResourceConverter
		ConverterName = The Spice
		StartActionName = Start Extending Life
		StopActionName = Stop Extending Life
		ToggleActionName = Toggle The Spice
		AutoShutdown = false
		GeneratesHeat = false
		UseSpecialistBonus = false
		
		//ExpectedCrew = 4.3
		INPUT_RESOURCE
		{
			ResourceName = SpiceMelange
			Ratio = 0.00134375 //0.003125
			%Ratio:NEEDS[TacLifeSupport] = 0.006002566 //0.001395946
		}
		INPUT_RESOURCE
		{
			ResourceName = ElectricCharge
			Ratio = 0.043
		}
		OUTPUT_RESOURCE:NEEDS[USILifeSupport]
		{
			ResourceName = Supplies
			Ratio = 0.00215 //0.0005
			DumpExcess = false
		}
		OUTPUT_RESOURCE:NEEDS[Snacks]
		{
			ResourceName = Snacks
			Ratio = 0.000149309 //0.000034723
			DumpExcess = false
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Food
			Ratio = 7.27865E-05 //0.000016927083333
			DumpExcess = false
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Water
			Ratio = 4.81087E-05 //0.000011188078704
			DumpExcess = false
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Oxygen
			Ratio = 0.007368212 //0.001713537562385
			DumpExcess = false
		}
	}
}

@PART[dsts_spiceapp_250|dsts_gardenL|dsts_gardenM]:NEEDS[USILifeSupport|TacLifeSupport|Snacks]
{
	MODULE
	{
		name = ModuleResourceConverter
		ConverterName = The Spice
		StartActionName = Start Extending Life
		StopActionName = Stop Extending Life
		ToggleActionName = Toggle The Spice
		AutoShutdown = false
		GeneratesHeat = false
		UseSpecialistBonus = false
		
		//ExpectedCrew = 6.45
		INPUT_RESOURCE
		{
			ResourceName = SpiceMelange
			Ratio = 0.002015625 //0.003125
			%Ratio:NEEDS[TacLifeSupport] = 0.009003849 //0.001395946
		}
		INPUT_RESOURCE
		{
			ResourceName = ElectricCharge
			Ratio = 0.0645
		}
		OUTPUT_RESOURCE:NEEDS[USILifeSupport]
		{
			ResourceName = Supplies
			Ratio = 0.003225 //0.0005
			DumpExcess = false
		}
		OUTPUT_RESOURCE:NEEDS[Snacks]
		{
			ResourceName = Snacks
			Ratio = 0.000223963 //0.000034723
			DumpExcess = false
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Food
			Ratio = 0.00010918 //0.000016927083333
			DumpExcess = false
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Water
			Ratio = 7.21631E-05 //0.000011188078704
			DumpExcess = false
		}
		OUTPUT_RESOURCE:NEEDS[TacLifeSupport]
		{
			ResourceName = Oxygen
			Ratio = 0.011052317 //0.001713537562385
			DumpExcess = false
		}
	}
}


//Add USI Logistics
// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
@PART[ds_boxred|ds_boxred_flat|ds_boxred_long|ds_boxwhite|ds_boxwhite_flat|ds_boxwhite_long]:NEEDS[000_USITools]
{
	MODULE
	{
		name = USI_ModuleResourceWarehouse
	}
}

@PART[dsts_spiceballoon]:NEEDS[000_USITools]
{
	MODULE
	{
		name = USI_ModuleResourceWarehouse
	}
}

@PART[dsts_gardenL|dsts_gardenM]:NEEDS[000_USITools]
{
	MODULE
	{
		name = USI_ModuleResourceWarehouse
	}
}


//Add TAC LS tanks to Spice Farms
// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
@PART[dsts_gardenL|dsts_gardenM]:NEEDS[TacLifeSupport]
{
	//@cost += 278
	
	RESOURCE
	{
		name = Food
		amount = 0
		maxAmount = 1124
	}
	
	RESOURCE
	{
		name = Water
		amount = 0
		maxAmount = 743
	}
	
	RESOURCE
	{
		name = Oxygen
		amount = 0
		maxAmount = 113782
	}
	
	RESOURCE
	{
		name = Waste
		amount = 0
		maxAmount = 194
	}
	
	RESOURCE
	{
		name = WasteWater
		amount = 0
		maxAmount = 1796
	}
	
	RESOURCE
	{
		name = CarbonDioxide
		amount = 0
		maxAmount = 186560
	}
}


//Add USI LS tanks to Spice Farms
// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
@PART[dsts_gardenL|dsts_gardenM]:NEEDS[USILifeSupport]
{
	//@cost += 12500
	
	RESOURCE
	{
		name = Supplies
		amount = 0
		maxAmount = 5000
	}
	
	RESOURCE
	{
		name = Mulch
		amount = 0
		maxAmount = 500
	}
}


//Add Snacks! to Spice Farms
// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
@PART[dsts_gardenL|dsts_gardenM]:NEEDS[Snacks]:AFTER[Snacks]
{
	//@cost += 800
	
	@RESOURCE[Snacks]
	{
		@amount *= 2
		@maxAmount *= 2
	}
}