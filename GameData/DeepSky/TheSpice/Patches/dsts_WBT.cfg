// Apply Refinery feature (KSC in-built storage)
@RESOURCE_DEFINITION[SpiceMelange]:NEEDS[WildBlueTools]:AFTER[TheSpice]
{
	@isTweakable = true
}
@RESOURCE_DEFINITION[WhiteSpice]:NEEDS[WildBlueTools]:AFTER[TheSpice]
{
	@isTweakable = true
}
@RESOURCE_DEFINITION[SpiceGas]:NEEDS[WildBlueTools]:AFTER[TheSpice]
{
	@isTweakable = true
}

REFINERY:NEEDS[WildBlueTools]
{
	techRequired = experimentalScience
	resourceName = SpiceMelange
	unitsPerDay = 0
	unitCostMultiplier = 1
	maxAmount = 1E+06
	unlockCost = 100000
}
REFINERY:NEEDS[WildBlueTools]
{
	techRequired = experimentalScience
	resourceName = WhiteSpice
	unitsPerDay = 0
	unitCostMultiplier = 1
	maxAmount = 2.5E+05
	unlockCost = 150000
}
REFINERY:NEEDS[WildBlueTools]
{
	techRequired = experimentalScience
	resourceName = SpiceGas
	unitsPerDay = 0
	unitCostMultiplier = 1
	maxAmount = 1E+08
	unlockCost = 250000
}

REFINERY:NEEDS[WildBlueTools,CommunityTechTree]
{
	techRequired = ResourceExploitation
	resourceName = SpiceMelange
	unitsPerDay = 2
	unitCostMultiplier = 1.5
	maxAmount = 1E+06
	unlockCost = 150000
}
REFINERY:NEEDS[WildBlueTools,CommunityTechTree]
{
	techRequired = ResourceExploitation
	resourceName = WhiteSpice
	unitsPerDay = 1
	unitCostMultiplier = 1.5
	maxAmount = 2.5E+05
	unlockCost = 200000
}
REFINERY:NEEDS[WildBlueTools,CommunityTechTree]
{
	techRequired = ResourceExploitation
	resourceName = SpiceGas
	unitsPerDay = 10
	unitCostMultiplier = 10
	maxAmount = 1E+08
	unlockCost = 400000
}


// Add Spice tank options to Wild Blue Industries parts as part upgrades
SPICE_TEMPLATE:NEEDS[WildBlueTools]
{
	name = SpiceMelange
	author = JadeOfMaar
	shortName = SpiceMelange
	logoPanel = DeepSky/TheSpice/Resources/Decals/SpiceMelange
	glowPanel = DeepSky/TheSpice/Resources/Decals/SpiceMelangeGlow
	description = This kit stores the Spice Melange. This omnipotent powder is convertible into many life sustaining substances and even some basic propellants.
	templateTags = stowage
	requiredResource = Equipment
	requiredAmount = 20
	reconfigureSkill = Engineer

	RESOURCE
	{
		name = SpiceMelange
		amount = 0
		maxAmount = 5600
	}
}

SPICE_TEMPLATE:NEEDS[WildBlueTools]
{
	name = WhiteSpice
	author = JadeOfMaar
	shortName = WhiteSpice
	logoPanel = DeepSky/TheSpice/Resources/Decals/WhiteSpice
	glowPanel = DeepSky/TheSpice/Resources/Decals/WhiteSpiceGlow
	description = This kit stores the White Spice. It is a new and even more elusive flavor of the Spice and which best serves as an alternate form of nuclear fuel.
	templateTags = stowage
	requiredResource = Equipment
	requiredAmount = 20
	reconfigureSkill = Engineer
	
	RESOURCE
	{
		name = WhiteSpice
		amount = 0
		maxAmount = 5600
	}
}

SPICE_TEMPLATE:NEEDS[WildBlueTools]
{
	name = SpiceGas
	author = JadeOfMaar
	shortName = SpiceGas
	logoPanel = DeepSky/TheSpice/Resources/Decals/SpiceGas
	glowPanel = DeepSky/TheSpice/Resources/Decals/SpiceGasGlow
	description = This kit stores the Orange Spice Gas.
	requiredResource = Equipment
	requiredAmount = 80
	reconfigureSkill = Engineer

	RESOURCE
	{
		name = SpiceGas
		amount = 0
		maxAmount = 56000
	}
}

// Buffalo body tanks
@PART[WBI_Tundra*]:NEEDS[Buffalo]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = TUNDRA;STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}

// Conestoga Multipurpose Base Module
@PART[WBI_MBM]:NEEDS[Pathfinder]
{
	@MODULE[WBIMultipurposeStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = CONESTOGA;STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}
// Mule Multipurpose Logistics Module
@PART[WBI_Conestoga]:NEEDS[Pathfinder]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}
// Chuckwagon Inflatable Warehouse
@PART[WBI_Chuckwagon]:NEEDS[Pathfinder]
{
	@MODULE[WBIMultipurposeStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = GREENHOUSE;STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}

// Buckboards
@PART[WBI_Buckboard]:NEEDS[Pathfinder]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = STORAGE_TEMPLATE;BUCKSCI1;SPICE_TEMPLATE
			}
		}
	}
}
@PART[WBI_Buckboard2]:NEEDS[Pathfinder]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = STORAGE_TEMPLATE;BUCKSCI2;SPICE_TEMPLATE
			}
		}
	}
}
@PART[WBI_Buckboard3]:NEEDS[Pathfinder]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = STORAGE_TEMPLATE;BUCKSCI3;SPICE_TEMPLATE
			}
		}
	}
}
@PART[WBI_Buckboard4]:NEEDS[Pathfinder]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = STORAGE_TEMPLATE;BUCKSCI6;SPICE_TEMPLATE
			}
		}
	}
}

// MOLE
// Category
@MODCAT:HAS[#title[Long?Duration?Exposure?Facility]]:NEEDS[MOLE]
{
	@folderName ^= :$:;TheSpice/Science/LDEF:
}

// Coaches
@PART[WBI_Coach225]:NEEDS[MOLE]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = COACH_SCIENCE;COACH_COMMNET;STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}
@PART[WBI_Coach500]:NEEDS[MOLE]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = EXPERIMENT_STOWAGE8;COACH_COMMNET;STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}
// WB-700 Storage Tank
@PART[WBI_WB700]:NEEDS[MOLE]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}
// Structural Adapter
@PART[WBI_Adapter]:NEEDS[MOLE]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = COACH_SCIENCE;STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}
// Titan tanks
@PART[WBI_Titan450|WBI_Titan900|WBI_Titan1800|WBI_TitanAdapterTank|WBI_SlantedAdapter]:NEEDS[MOLE]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}
// Station Hub
@PART[WBI_StationHub2]:NEEDS[MOLE]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}