// Apply Refinery feature (KSC in-built storage)
@RESOURCE_DEFINITION[SpiceMelange]:NEEDS[WildBlueTools]:AFTER[TheSpice]
{
	@isTweakable = true
}
@RESOURCE_DEFINITION[WhiteSpice]:NEEDS[WildBlueTools]:AFTER[TheSpice]
{
	@isTweakable = true
}
@RESOURCE_DEFINITION[SpiceGas]:NEEDS[WildBlueTools]:AFTER[TheSpice]
{
	@isTweakable = true
}

REFINERY:NEEDS[WildBlueTools]
{
	techRequired = experimentalScience
	resourceName = SpiceMelange
	unitsPerDay = 0
	unitCostMultiplier = 1
	maxAmount = 1E+06
	unlockCost = 100000
}
REFINERY:NEEDS[WildBlueTools]
{
	techRequired = experimentalScience
	resourceName = WhiteSpice
	unitsPerDay = 0
	unitCostMultiplier = 1
	maxAmount = 2.5E+05
	unlockCost = 150000
}
REFINERY:NEEDS[WildBlueTools]
{
	techRequired = experimentalScience
	resourceName = SpiceGas
	unitsPerDay = 0
	unitCostMultiplier = 1
	maxAmount = 1E+08
	unlockCost = 250000
}

REFINERY:NEEDS[WildBlueTools,CommunityTechTree]
{
	techRequired = ResourceExploitation
	resourceName = SpiceMelange
	unitsPerDay = 2
	unitCostMultiplier = 1.5
	maxAmount = 1E+06
	unlockCost = 150000
}
REFINERY:NEEDS[WildBlueTools,CommunityTechTree]
{
	techRequired = ResourceExploitation
	resourceName = WhiteSpice
	unitsPerDay = 1
	unitCostMultiplier = 1.5
	maxAmount = 2.5E+05
	unlockCost = 200000
}
REFINERY:NEEDS[WildBlueTools,CommunityTechTree]
{
	techRequired = ResourceExploitation
	resourceName = SpiceGas
	unitsPerDay = 10
	unitCostMultiplier = 10
	maxAmount = 1E+08
	unlockCost = 400000
}

// Add Spice tank options to Wild Blue Industries parts as part upgrades
SPICE_TEMPLATE:NEEDS[WildBlueTools]
{
	name = SpiceMelange
	author = JadeOfMaar
	shortName = SpiceMelange
	logoPanel = DeepSky/TheSpice/Resources/Decals/SpiceMelange
	glowPanel = DeepSky/TheSpice/Resources/Decals/SpiceMelangeGlow
	description = This kit stores the Spice Melange. This omnipotent powder is convertible into many life sustaining substances and even some basic propellants.
	templateTags = stowage
	requiredResource = Equipment
	requiredAmount = 20
	reconfigureSkill = Engineer

	RESOURCE
	{
		name = SpiceMelange
		amount = 0
		maxAmount = 5600
	}
}

SPICE_TEMPLATE:NEEDS[WildBlueTools]
{
	name = WhiteSpice
	author = JadeOfMaar
	shortName = WhiteSpice
	logoPanel = DeepSky/TheSpice/Resources/Decals/WhiteSpice
	glowPanel = DeepSky/TheSpice/Resources/Decals/WhiteSpiceGlow
	description = This kit stores the White Spice. It is a new and even more elusive flavor of the Spice and which best serves as an alternate form of nuclear fuel.
	templateTags = stowage
	requiredResource = Equipment
	requiredAmount = 20
	reconfigureSkill = Engineer
	
	RESOURCE
	{
		name = WhiteSpice
		amount = 0
		maxAmount = 5600
	}
}

SPICE_TEMPLATE:NEEDS[WildBlueTools]
{
	name = SpiceGas
	author = JadeOfMaar
	shortName = SpiceGas
	logoPanel = DeepSky/TheSpice/Resources/Decals/SpiceGas
	glowPanel = DeepSky/TheSpice/Resources/Decals/SpiceGasGlow
	description = This kit stores the Orange Spice Gas.
	requiredResource = Equipment
	requiredAmount = 80
	reconfigureSkill = Engineer

	RESOURCE
	{
		name = SpiceGas
		amount = 0
		maxAmount = 56000
	}
}

// Buffalo body tanks
@PART[WBI_Tundra*]:NEEDS[Buffalo]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = TUNDRA;STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}

// Conestoga Multipurpose Base Module
@PART[WBI_MBM]:NEEDS[Pathfinder]
{
	@MODULE[WBIMultipurposeStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = CONESTOGA;STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}
// Mule Multipurpose Logistics Module
@PART[WBI_Conestoga]:NEEDS[Pathfinder]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}
// Chuckwagon Inflatable Warehouse
@PART[WBI_Chuckwagon]:NEEDS[Pathfinder]
{
	@MODULE[WBIMultipurposeStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = GREENHOUSE;STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}

// Buckboards
@PART[WBI_Buckboard]:NEEDS[Pathfinder]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = STORAGE_TEMPLATE;BUCKSCI1;SPICE_TEMPLATE
			}
		}
	}
}
@PART[WBI_Buckboard2]:NEEDS[Pathfinder]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = STORAGE_TEMPLATE;BUCKSCI2;SPICE_TEMPLATE
			}
		}
	}
}
@PART[WBI_Buckboard3]:NEEDS[Pathfinder]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = STORAGE_TEMPLATE;BUCKSCI3;SPICE_TEMPLATE
			}
		}
	}
}
@PART[WBI_Buckboard4]:NEEDS[Pathfinder]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = STORAGE_TEMPLATE;BUCKSCI6;SPICE_TEMPLATE
			}
		}
	}
}

// MOLE
// Category
@MODCAT:HAS[#title[Long?Duration?Exposure?Facility]]:NEEDS[MOLE]
{
	@folderName ^= :$:;TheSpice/Science/LDEF:
}

// Coaches
@PART[WBI_Coach225]:NEEDS[MOLE]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = COACH_SCIENCE;COACH_COMMNET;STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}
@PART[WBI_Coach500]:NEEDS[MOLE]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = EXPERIMENT_STOWAGE8;COACH_COMMNET;STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}
// WB-700 Storage Tank
@PART[WBI_WB700]:NEEDS[MOLE]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}
// Structural Adapter
@PART[WBI_Adapter]:NEEDS[MOLE]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = COACH_SCIENCE;STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}
// Titan tanks
@PART[WBI_Titan450|WBI_Titan900|WBI_Titan1800|WBI_TitanAdapterTank|WBI_SlantedAdapter]:NEEDS[MOLE]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}
// Station Hub
@PART[WBI_StationHub2]:NEEDS[MOLE]
{
	@MODULE[WBIConvertibleStorage]
	{
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = dsts_BlueSpice
				description__ = Adds Spices to resource menu.
				techRequired__ = experimentalScience
				templateNodes = STORAGE_TEMPLATE;SPICE_TEMPLATE
			}
		}
	}
}

// Cruise Control :: Is huge krakenbait right now :c
// @PART[dsts_fusionengine|ds00_japierI*]:NEEDS[WildBlueTools]
// {
	// @MODULE[ModuleEnginesFX],*
	// {
		// @name = ModuleEnginesFXWBI
		// canUpdateParticleEffects = false
	// }
	// MODULE
	// {
		// name = WBICruiseControl

		//This is a cheat that essentially multiplies the mass flow rate used to calculate delta v during timewarp.
		//All it does is let you burn your fuel faster than normal, thus creating more delta v faster.
		//It does NOT give you extra resources, it just lets you use them more quickly.
		// fuelBurnMultiplier = 10
	// }
// }

// Tooltips
@PART[ds00_japierI*]:NEEDS[WildBlueTools]
{
	PART_TIP
	{
		name = dstt_japier
		title = Japier Spice Drive
		description = An immensely powerful all-purpose engine. As an air-breather it produces thrust by compressing Atmosphere in its magnetic rail chamber to the point of pulsed ignition/detonation. As a chemical rocket it ignites Spice Gas with a specific and great electrical current. This engine can use WBI Cruise Control.
	}
}
@PART[ds00_mrengine*]:NEEDS[WildBlueTools]
{
	PART_TIP
	{
		name = dsts_mrengine
		title = Multi-Role Heavy Lifter
		description = The Sirona series rocket, named after a gas giant, trades Isp for raw power and more gimbal range. It enables even the heaviest and least aerodynamic of ships to land on planets like Eve, Tellumo or Titanus, and SSTO again. This engine can also perform in SupraLOX hybrid LFO mode.
	}
}
@PART[dsts_fusionengine]:NEEDS[WildBlueTools]
{
	PART_TIP
	{
		name = dsts_fusionengine
		title = Fusion Drive
		description = The ultimate in chemical reaction engine technology. It really sips on Spice Gas but requires an incredibly powerful source of ElectricCharge and a moderate thermal control system to maintain peak operation. Do not attempt to use this in atmosphere. This engine can use WBI Cruise Control.
	}
}
@PART[dsts_fusioncore]:NEEDS[WildBlueTools]
{
	PART_TIP
	{
		name = dsts_fusioncore
		title = Fusion Core
		description = The ultimate power source, or at least, one among them. In addition to potentially containing a dwarf star while active, it serves as a Hadron Collider and additionally renders interesting byproducts, namely MonoPropellant and Glykerol. Be sure to check whether this device needs a thermal control system before adding it to a ship.
	}
}
@PART[dsts_spiceapp*]:NEEDS[WildBlueTools]
{
	PART_TIP
	{
		name = dsts_spiceapp
		title = The Spice extends life
		description = If a life support system is installed, this device will not only convert delicious food and so on from the Spice Melange, it will also render interesting byproducts, namely MonoPropellant and Glykerol.
	}
}
@PART[dsts_garden*]:NEEDS[WildBlueTools]
{
	PART_TIP
	{
		name = dsts_garden
		title = The Spice extends life
		description = This massive habitat serves to emulate sea level conditions akin to the arid and near-arid regions on Kerbin. With a large serving of Worm Essence, we aim to cultivate a full-sized sand worm inside, which in turn, will produce all of the Spice.
	}
}
@PART[dsts_scanner]:NEEDS[WildBlueTools]
{
	PART_TIP
	{
		name = dsts_scanner
		title = Spice-O-Meter
		description = This device detects the Spice. Simply enter the sphere of influence of a candidate world and the device will precisely reveal the abundance (if any) of Spice Gas.
	}
}
@PART[dsts_multisci]:NEEDS[WildBlueTools]
{
	PART_TIP
	{
		name = dsts_multisci
		title = The Spice expands consciousness
		description = This mutli-functional device (MFD) is capable of two very unique science experiments engineered to reveal more details about the Spice Planet. It is also a surface scanner and is capable of detecting the Worm Essence, which is vital to the operation of the Spice Gardens.
	}
}
@PART[dsts_warp*]:NEEDS[WildBlueTools]
{
	PART_TIP
	{
		name = dsts_warp
		title = The Spice folds space
		description = The Taranis series is an Alcubierre style warp drive. It currently requires, and outperforms, the USI brand warp drives. Its much larger warp bubble accommodates ships with much greater sizes and feature sets. It contains a subspace antenna and can be used to expand consciousness. One of these can be scaled only larger. The other can be scaled only smaller.
	}
}
